[{"title":"物理层及数据链路层","date":"2020-08-03T14:15:53.214Z","path":"2020/08/03/物理层&链路层/","text":"物理层物理层的功能不需要地址 Frame 13： 74 bytes on wire (592 bits),74 bytes captured (592 bits) 13号帧，线路74字节，实际捕获74字节 123456789Encapsulation type： Ethernet(1) # 封装类型Arrival Time: # 捕获日期和时间Epoch Time：# 时间戳，另一种时间表示方式[Time delta from previous captured frame: ] #此包与前一包的时间间隔[Time since reference or first frame: ] #此包与第一帧的时间间隔Frame Number: # 帧序号Frame Length: # 帧长度Capture Length： # 捕获长度 （通常情况下帧长度和捕获长度是相同的）Protocols in frame：帧内封装的协议层次结构 EtherType 是以太帧里的一个字段，用来指明应用于帧数据字段的协议 链路层主要目的： 1231. 为IP模块发送和接收IP数据报2. 为ARP模块发送ARP请求和接收ARP应答3. 为RARP发送RARP请求和接收RARP应答 以太网和IEEE 802 封装以太网是当今TCP/IP采用的主要的局域网技术，它采用一种称作CSMA/CD的媒体接入方法，其意思是带冲突检测的载波侦听多路接入。它的速率是10Mb/s，地址为48bit。 前导码(8B)：在帧的前面插入8B，使接收端和发送端进行时钟同步，其中7B为前同步码，1B为帧开始定界符。 12前同步码均为：10101010帧开始定界符为：10101011，最后一个字节为告诉接收端“重要的帧开始了” 目的MAC(6B)：包含目的主机网卡MAC地址或广播地址 源MAC(6B)：发送端的网卡MAC地址 类型(2B)：之处接收端收到该帧时，将该帧的载荷数据交付给谁处理 10x0800:IPv4 802.1Q标签： CRC(4B)：为了让接收端对接收到的帧进行差错检验(也做帧校验序列，FCS) FCS: 该字段有 4 个字节，表示帧校验序列，用于校验帧是否出错。该字段内容已被网络设备滤去，抓包软件已无法获取。 帧间距：表示两个Frame之间间隔大小，设备发送完一个Frame后，并不会立刻发送下一个，而是等待IFG的间隔才会继续发送。 最小的帧间隙为12bytes，主要为了避免冲突(参考以太网的CSMA/CD特定) 抓包 为什么wireshark抓不到帧尾的FCS 4字节和以太网V2的前序8字节？ 因为wireshark把这2个都给过滤了。 在物理层上网卡要先去掉前导同步码和帧开始定界符，然后对帧进行CRC检验，如果帧校验和错，就丢弃此帧。如果校验和正确，就判断帧的目的硬件地址是否符合自己的接收条件（目的地址是自己的物理硬件地址、广播地址、可接收的多播硬件地址等），如果符合，就将帧交“设备驱动程序”做进一步处理。这时我们的抓包软件才能抓到数据，因此，抓包软件抓到的是去掉前导同步码、帧开始分界符、FCS之外的数据 通过OmniPeek抓包查看FCS内容： 环回概念：使用Internet协议与同一计算机上的服务器通信。为实现这个目标，大多数实现支持一种工作在网络层的环回能力，通常使用一个虚拟的环回网络接口来实现。 MTU概念MTU：最大传输单元，MTU是数据链路层的概念，MTU限制的是数据链路层的payload，即上层协议的大小，如IP，ICMP等。 （涉及到的内容分片和重组） OSI中的层 功能 TCP/IP协议族 应用层 文件传输，电子邮件，文件服务，虚拟终端 TFTP，HTTP，SNMP，FTP，SMTP，DNS，Telnet 表示层 数据格式化，代码转换，数据加密 没有协议 会话层 解除或建立与别的接点的联系 没有协议 传输层 提供端对端的接口 TCP，UDP 网络层 为数据包选择路由 IP，ICMP，RIP，OSPF，BGP，IGMP 数据链路层 传输有地址的帧以及错误检测功能 SLIP，CSLIP，PPP，ARP，RARP，MTU 物理层 以二进制数据形式在物理媒体上传输数据 ISO2110，IEEE802，IEEE802.2 作用：为什么是1500? 标准的以太网数据帧大小是：1518，头信息有14字节，尾部校验和FCS占了4字节，所以真正留给上层协议传输数据的大小就是：1518 - 14 - 4 = 1500 抓包 ping 2.2.2.2 ping 2.2.2.2 -l 1 数据大小设置为1，此时抓包可见Padding内容，使得payload达到最小要求(MTU–&gt; 46，若加上头部信息，为64) ping 2.2.2.2 -l 2000 出现了分片，分为1514及562两个报文 1514 = 6+6+2+20(IPv4头部)+1480(payload)","tags":[]},{"title":"网络连接设备","date":"2020-08-03T14:15:53.207Z","path":"2020/08/03/网络连接设备/","text":"转发器/集线器仅发生在物理层，完成比特数据在物理层的传输 作用：实现物理层的连接，对衰减的信号进行放大整形或再生，起到扩展网段距离的作用。 网桥/交换机交换机作用于数据链路层和物理层 交换机是一种用于电信号转发的网络设备。它可以为接入交换机的任意两个网络节点提供独享的电信号通路。 A–D之间的数据交换没有进过网桥，这是因为两者连接在网桥的同一个端点处。 A–G之间的数据交换进过网桥，这是因为两者连接在网桥不同的端点处 路由器路由器是用来延伸、拓展网络的设备。 一个接口连接是一个网络，在局域网内部通常使用集线器或交换机扩展网络 网关网关(Gateway)又称网间连接器、协议转换器。网关在传输层上以实现网络互连，是最复杂的网络互连设备，仅用于两个高层协议不同的网络互连。 网关是一种充当转换重任的计算机系统或设备。在使用不同的通信协议、数据格式或语言,甚至体系结构完全不同的两种系统之间，网关是一个翻译器。与网桥只是简单地传达信息不同，网关对收到的信息要重新打包，以适应目的系统的需求。同时，网关也可以提供过滤和安全功能。大多数网关运行在OSI 7层协议的顶层–应用层","tags":[]},{"title":"TCP-IP详解概述","date":"2020-08-03T14:15:53.189Z","path":"2020/08/03/概述/","text":"OSI参考模型 ISO标准(ISO组织制定) ​ 开放系统互连(open system interconnection)，将不同系统进行互连所构建的模型 ​ 参考模型：不是实际的协议，并不是在实际过程汇总进行实用的模型，而是作为参考、知道的模型 目的 ​ 使两个不同的系统能够通信，而不需要改变底层的硬件或软件逻辑 ​ 不同的系统：一台计算机、一部电话 OSI不是协议，是网络体系结构的概念模型 层次体系结构网络支持层：为通信提供传输的支持 应用支持层：通常由软件实现的，应用软件，为网络应用提供相应的支持 传输层：将上下两层结合在一起 对等层通信层次模型在通信过程中是如何使用的。 A 和 B 通过中间节点进行通信(网络互连设备) 两个系统之间如何实现通信，其通信方式称为对等层通信。 对等层概念可通过层次模型进行对应。 下层：服务提供者 上层：服务使用者 接口：层与层之间存在一个接口，为了实现层与层之间服务的提供与使用的通道 对等层：不同主机之间的相同层次被称为对等层(Peer)。主机A的应用层和主机B的应用层互为对等层、主机A的会话层和主机B的会话层互为对等层 对等进程/对等实体 对等层协议：对等实体之间交换数据或通信时必须遵守的规则 对等层与对等实体： 1234# 每一层可以同时存在多个实体 存在通信关系的对等层实体才是对等实体# 每一层可以同时存在多个协议 协议是对等实体间的通信规则 数据通信-封装7层模型，最上一层直接面向用户，最下一层直接面向物理介质。真正的数据传输方向是发送方是由高层送往底层，接收方由底层依次送往高层 PDU：协议数据单元，对等实体之间通信时所传输的信息内容，每一层封装成的PDU均有自己的名字 12345应用层、表示层和会话层封装成的PDU被统一称为Data(数据)传输层的被称为数据段(segement)在网络层的被称为packet(IP数据包，分组)数据链路层(frame)帧物理层的被称为bit流 在OSI参考模型看来，数据通信时，是一层一层处理，逐层封装好，在物理上进行实在的传输：从源主机（SOURCE）的应用层发出来的数据是有一定格式的协议数据单元，称为PDU（protocol data unit）。应用层发给下一层表示层后，在PDU前面加上了本层控制信息，也就是图中的AH，加在头部。加了头部PH的A-PDU，更新为本层的PDU，也就是要发给第五层会话层的内容。即A-PDU+PH=P-PDU。上一层向下一层发送PDU，逐层加上本层的头部后成为下一层的PDU。直至发到数据链路层，数据链路层还加一个尾部，也就是DT，起到校验作用，如果数据正确，继续传输，数据错误直接丢掉不继续传输。数据链路层发给物理层后，物理层将PDU转换为二进制编码（比特流），通过硬件转换为信号发送出去。这样源主机七层任务完成。 图右侧是目的主机的数据接收过程：接收到硬件的二进制信号后，物理层转换为PDU发个数据链路层。数据链路层拆掉头部和尾部后，将赤裸的PDU送给网络层。网络层再拆掉头部，送入下一层，逐层拆掉头部，到了送给应用层时，前面不同层添加的头部完全被拆干净，留下原本发送的最原始PDU，也就是用户数据。 在构造协议数据单元时会在头部增加控制信息，这些控制信息包括：1) 地址：用来标识发送端和接收端，源主机得知道数据往哪发，目的主机得知道数据是发给谁的 2) 差错检测编码：用于差错检测或纠正 3）协议控制：实现协议功能的附加信息(优先级、服务质量及安全控制等) 层次功能 层次 功能 网络协议 应用层 提供应用协议，用户与网络面对面菜刀接口 HTTP、TFTP、FTP、SMTP 表示层 数据的编码、翻译、压缩、解压缩、加密、解密、将数据翻译为相对应的编码格式，然后展现到应用程序中 telnet、Rlogin、SNMP、Gopher 会话层 主要用来管理会话(建立连接、保持连接、断开连接) SMTP、DNS 传输层 提供端到端的连接方式(可靠的传输方式、不可靠的传输方式、数据包重组) TCP、UDP 网络层 负责设备的IP地址寻址，寻找网络中目的位置，并在去往目的的多条路径中选择一条最佳的路径 IP、ICMP、ARP、RARP、AKP、UUCP 数据链路层 协商、流量控制、差错控制、物理寻址 FDDI、Ethernet、Arpanet、PDN、PPP 物理层 定义了网络通信接口及介质的标准，以及将上层封装的数据转换为bit的二进制方式进行传输 IEEE802.1A，IEEE 802.2到IEEE 802.11 TCP/IP协议族 TCP/IP分层TCP/IP通常被认为是一个四层协议系统，每一层负责不同的功能。 链路层：数据链路层或网络接口层，通常包括操作系统中的设备驱动程序和计算机中对应的网络接口卡。一起处理与电缆(或其他任何传输媒介)的物理接口细节。 网络层：处理分组在网络中的活动，如分组的选路。网络层协议包括IP协议(网际协议)、ICMP协议(Internet互联网控制报文协议)，以及IGMP协议(Internet组管理协议) 运输层：主要为两台主机上的应用程序提供端到端的通信。 ​ TCP(传输控制协议)：为两台主机提供高可靠性的数据通信，它所做的工作包括把应用程序交给它的数据分成合适的小块交给下面的网络层，确定接收到的分组，设置发送最后确认分组的超时时钟等。 ​ UDP(用户数据报协议)：为应用层提供一种非常简单的服务，不可靠的数据通信。 应用层：负责处理特定的应用程序细节 1234telnet:远程登录FTP：文件传输协议SMTP：简单邮件传送协议SNMP：简单网络管理协议 TCP和UDP是两种最为著名的运输层协议，二者都使用IP作为网络层协议。 TCP虽然使用不可靠的IP服务，但却提供一种可靠的运输层服务 UDP为应用程序发送和接收数据报，一个数据包是指从发送方传输到接收方的一个信息单元。UDP是不可靠的，不能保证数据报能安全无误的达到最终目的 IP是网络层上的主要协议，同时被TCP和UDP使用 ICMP是IP协议的附属协议，IP层用它来与其它主机或路由器交换报错报文和其它重要信息。 IGMP是Internet组管理协议，它用来把一个UDP数据报多播到多个主机。 ARP(地址解析协议)和RARP(逆地址解析协议)是某些网络接口使用的特殊协议，用来转换IP层和网络接口层使用的地址。 封装当应用程序用TCP传送数据时，数据被送入协议栈中，然后逐个通过每一层知道被当做一串比特流送入网络。 TCP传给IP的数据单元称作TCP报文段或简称为TCP端 IP传给网络接口层的数据单元称作IP数据报 通过以太网传输的比特流称作帧 以太网数据帧的物理特性是其长度必须在46~1500字节之间 编址物理地址 用来标识通信的节点(物理网内部) 节点由所属的LAN或WAN指定 在局域网或广域网内是唯一的 也称为链路地址/硬件地址 并不是用于物理层，而是用于数据链路层(物理层主要完成比特流的传送，仅涉及到信号转换，不涉及寻址) IP地址 标识通信节点的网络连接(逻辑网络内) 该地址有Internet指定，在Internet内唯一 32bit，点分十进制进行标识 端口地址 标识于通信进程 由操作系统来指定，在一台计算机内是唯一的 作用于传输层，用于标识应用层的信息 TCP/IP中的地址与层次 抓包 更新图标","tags":[]},{"title":"地址解析协议","date":"2020-08-03T14:15:53.169Z","path":"2020/08/03/地址解析协议/","text":"地址解析协议(ARP)提供了一种IPv4地址和各种网络技术使用的硬件地址之间的映射。 ARP仅用于IPv4、IPv6使用邻居发现协议，被合并入ICMPv6 直接交付ARP运行要求：仅适用于广播网络，链路层能将一个消息交付到它连接的所有网络设备。 在一个共享的链路层网段上，ARP向所有主机发送一个称为ARP请求的以太网帧。 以太网主机在同一广播域中，ARP查询使用链路层广播帧发送，并被所有主机接收。 IP地址匹配的主机直接向请求主机返回响应。IP地址不匹配的主机主动丢弃ARP查询 ARP缓存表ARP高效运行的关键是维护每个主机结合路由器上的ARP缓存表。 该缓存使用地址解析为每个接口维护从网络层地址到硬件地址的最新应用。 当IPv4地址映射到硬件地址时，它对应于高速缓存中的一个条目，其正常到期时间是条目创建开始后的20分钟。 查看ARP缓存表： 123456789arp -a接口: 192.168.31.33 --- 0xe Internet 地址 物理地址 类型 192.168.31.1 28-6c-07-0a-11-3a 动态 192.168.31.157 88-bf-e4-99-fa-b0 动态 192.168.31.255 ff-ff-ff-ff-ff-ff 静态 224.0.0.2 01-00-5e-00-00-02 静态 224.0.0.22 01-00-5e-00-00-16 静态 动态ARP动态ARP指的是通过报文去学习ARP表项，不需要管理员手工建立和维护，动态条目随时间推移自动添加和删除 每个动态ARP缓存条目默认的生命周期是两分钟。当超过两分钟，该条目会被删掉。所以，生命周期也被称为超时值。 延长规则：当ARP条目已存在，使用该条目后，将会重设超时值为两分钟。 静态ARP静态ARP指的是需要管理员手工指定建立AP-MAC映射表，需要管理员手工建立和维护。 ARP帧格式 硬件类型：表示硬件地址的类型，值为1表示以太网地址 协议类型：表示要映射的协议地址类型，值为0x0800表示IP地址类型 硬件地址长度和协议地址长度：分别指出硬件地址和协议的长度，以字节为单位。对于以太网上 IP 地址的ARP请求或应答来说，它们的值分别为 6 和 4 操作类型(op)：1表示ARP请求，2表示ARP应答，RARP 请求为 3，RARP 响应为 4 免费ARP免费ARP：发生在一台主机发送ARP请求以寻找自己的地址 应用： 用于检测IP地址冲突，当一台主机发送了免费ARP请求报文后，如果收到了ARP响应报文，则说明网络内衣存在使用该IP的主机 利用免费ARP确认设备接口IP地址 使用免费ARP报文，更新某些设备的ARP表现 利用免费ARP的攻击","tags":[]},{"title":"","date":"2020-08-03T14:15:53.159Z","path":"2020/08/03/ping抓包分析/","text":"arp1234# 查看ARP表arp -a# 删除ARP表arp d A(1.1.1.4) — &gt; ping —&gt; B(1.1.1.2) 当主机A向主机B发送数据时，主机A首先会在自己的ARP缓存表中寻找是否存在目标IP地址，如果找到了，也就知道了相应的MAC地址，直接将目标MAC值写入帧里发送即可。 若在ARP缓存表中没有找到对应的IP地址，主机A会在网络中发送一个广播，目标MAC地址为ff.ff.ff.ff.ff.ff，表示向同一网段内的所有主机发出这样的询问，1.1.1.2的MAC地址是什么？ 网络上其他主机并不响应ARP询问，只有主机B接收到这个帧时，才会向主机A做出回应：1.1.1.2的MAC地址是么。 这样主机A就知道了主机B的MAC地址，可以向主机B发送信息了。 同时还更新了自己的ARP缓存表，再次再向主机B发送信息时，直接从ARP缓存表里查找就可以了。 ARP缓存表采用了老化机制，在一段时间内如果表中的某一行没有使用，就会被删除，减少了ARP缓存表的长度，加快查询速度。 由于ARP有缓存机制，为了防止ARP过期，结束后重新更新下ARP缓存，保证下次请求能去往正确的路径，如果ARP过期就会导致出现一次错误，从而影响测试准确性 PC1 —&gt; PC2 首先判断是否为","tags":[]},{"title":"Internet控制报文协议","date":"2020-08-03T14:15:53.155Z","path":"2020/08/03/Internet控制报文协议/","text":"概述问题： IP协议本身并没有为终端系统提供直接的方法来发现那些发往目的地址失败的IP数据包。 IP没有提供直接的方式来获取诊断信息 解决： ICMP：Internet控制报文协议： 与IP结合使用，以便提供与IP协议层配置和IP数据包处置相关的诊断和控制信息 ICMP不为IP网络提供可靠性，表明了某些类别的故障和配置信息 ICMP在IPv4和IPv6中的封装IPv4： IPv6： ICMP报文格式 以8位的类型和代码字段开始 其后的16位校验和字段涵盖了整个报文 ICMPv4中为类型字段保留了42个不同的值，用于确定特定的报文 ICMPv6中，将涵盖一个来自IPv6头部的伪头部(pseudo-header) ICMP报文分类： 差错报文：有关IP数据报传递的ICMP报文 查询或信息类报文：有关信息采集和配置的ICMP报文 ICMPv4报文 类型 正式名称 参考 E/I 用途/注释 0(*) 回显应答 RFC0792 I 回显(ping)应答，返回数据 3(*)(+) 目的不可达 RFC0792 E 不可达的主机/协议 4 源端抑制 RFC0792 E 表示拥塞(弃用) 5(*) 重定向 RFC0792 E 表示应该被使用的可选路由 8(*) 回显 RFC0792 I 回显(ping)请求（数据可选） 9 路由器通告 RFC1256 I 请求路由器通告 10 路由器请求 RFC1256 I 请求路由器通告 11(*)(+) 超时 RFC0792 E 资源耗尽(例如IPv4 TTL) 12(*)(+) 参数问题 RFC0792 E 有问题的数据包或头部 ICMPv6报文ICMPv6负责的不仅是差错和信息类报文，也负责大量IPv6路由器和主机的配置。 ICMPv6中，差错报文的报文类型从0-127，信息类报文的报文类型从128-255。 处理ICMP报文一般情况下： 传入的信息类请求将被操作系统自动处理 差错类报文传递给用户进程或传输层协议","tags":[]},{"title":"Internet地址结构","date":"2020-08-03T14:15:53.139Z","path":"2020/08/03/Internet地址结构/","text":"概述IP地址–通用标识符 唯一标识互联网上的主机或路由器(唯一、通用、网络连接) 主机标识符 name：是什么，可读性强 address：在哪里，软件效率高 route：如何达到 IP地址表示IPv4地址 长度为32 bit 采用所谓的点分四组或点分十进制表示法 每个数字是一个非负整数，范围为[0-255]，代表整个IP地址的四分之一 IPv6地址 长度为128 bit IPv6地址的传统表示方法为采用称为块或字段的4个十六进制数，这些称为块或字段的数由==冒号==分隔 IPv6地址简化表示： 一个块中前导的零必须压缩 全零的块可以省略，并用符号::代替(::只能用于影响最大的地方，压缩最多的零)，一个IPv6地址中只能使用一次::符号 在IPv6格式中嵌入IPv4地址可使用混合符号形式，紧接着IPv4部分的地址块的值为ffff，地址的其余部分使用点分四组格式(IPv4映射的IPv6地址)【::ffff:10.0.0.1 –&gt; 10.0.0.1】 IPv6地址的低32位通常采用点分四组表示法（IPv4兼容的IPv6）【::0102:f001 –&gt; 1.2.240.1】 a到f的16进制数字应该用小写表示 IP地址结构分类寻址IP地址组成：网络部分和主机部分 网络部分：用于识别接口使用的IP地址在哪个网络中发现 主机地址：用于识别由网络部分给出的网络中的特定主机 地址中的一些连续位称为网络号，其余称为主机号。 用于表示通信节点的IP地址为A、B、C三类，用于为Internet(单播地址)中的接口分配地址 D：供组播使用 E：保留地址 特殊网络地址 特殊地址 Net id Host ID 源/目的地址 网络地址 特定的 全0 都不是 直接广播地址 特定的 全1 目的地址 受限广播地址 全1 全1 目的地址 本网络上的本主机 全0 全0 源地址(0.0.0.0) 本网络上的特定主机 全0 特定的 目的地址 环回地址 127 任意 目的主机 网络地址：仅用于标识网络，而不标识网络内的任意节点，标识的是一个网络集合 直接广播地址：标识对特定网络的广播 受限广播地址(本地广播地址)：标识对本地网络的广播 本网络上的特定主机：仅可作为源地址，获取自己的IP地址而临时使用的IP地址 子网掩码子网掩码是由一台主机或路由器使用的分配位，以确定如何从一台主机对应IP地址中获取网络和子网信息。 掩码由路由器和主机使用，以==确定一个IP地址的网络/子网部分的结束和主机部分的开始。== 表示网络或子网的大小 32 bits 二进制数 1表示一个IP地址的对应位与一个地址的网络/子网部分的对应位集合 0表示一个IP地址的对应位作为主机ID的一部分 可变长度子网掩码VSLM(可变长度子网掩码)：用于分割一个网络号，使每个子网支持不同数量的主机。提高子网结构的灵活性 如何确定可变子网长度？确定可变子网掩码长度的过程其实就是划分子网的过程。 当从主机位中借1位二进制位时，当前网络可划分出2个子网，每个子网主机数是原来的1/2-2；当从主机位中借2位二进制位时，当前网络可划分出4个子网，每个子网主机数是原来的1/4-2……当从主机位中借N位二进制位时，当前网络可划分为2N个子网，每个子网主机数是原来的2-N-2 192.168.10.0/24这个C类网络要划分出2个相等主机数的子网，则 网络号与子网掩码转为二进制 12网络号 192.168.10.0 转为二进制 11000000 10101000 00001010 00000000子网掩码 255.255.255.0 转为二进制 11111111 11111111 11111111 00000000 要把一个网络划分成两个相等子网，子网掩码要加1位，变成11111111 11111111 11111111 10000000 网络号从主机位借一位用于子网11000000 10101000 00001010 XYYYYYYY X位代表借入的，用于表示子网号，7个Y代表剩余主机位，X有两个值0和1。 1）为0时： ​ 11000000 10101000 00001010 0YYYYYYY ​ 当Y全为0，表示划分出的这个子网的网络号，为11000000 10101000 00001010 00000000 ​ 其主机可用IP地址范围是： ​ 11000000 10101000 00001010 0 0000001（192.168.10.1，掩码：255.255.255.128） ​ 至 ​ 11000000 10101000 00001010 0 1111110（192.168.10.126，掩码：255.255.255.128） 2）为1时 ​ 11000000 10101000 00001010 1YYYYYYY ​ 当Y全为0，表示划分出的这个子网的网络号，为11000000 10101000 00001010 10000000 ​ 其主机可用IP地址范围是： ​ 11000000 10101000 00001010 1 0000001（192.168.10.129，掩码：255.255.255.128） ​ 至 ​ 11000000 10101000 00001010 1 1111110（192.168.10.254，掩码：255.255.255.128） 综述，192.168.10.0/24要划分成两个相等主机数的子网，子网掩码要改为25位，划分出的两个子网情况是： 子网1： 网络号：192.168.10.0 子网掩码：255.255.255.128 广播地址：192.168.10.127 主机IP地址范围：192.168.10.1至192.168.10.126 子网2： 网络号：192.168.10.128 子网掩码：255.255.255.128 广播地址：192.168.10.255 主机IP地址范围：192.168.10.129至192.168.10.254 广播地址 定向广播地址 1231. 通过子网掩码取反与IP地址按位或运算得到2. 可作为一个单独的数据报通过Internet路由直至到达目标子网，再作为一组数据报发送给子网中所有主机* 由于安全问题，其在Internet中被禁用 本地网络广播(有限广播) 1231. 特殊地址：255.255.255.2552. 不会被路由器转发,链路层的广播机制用于支持它们3. 广播地址可用于IPv4中，而IPv6仅使用组播地址 IPv6地址和接口标识符IPv6特点： 一个IPv6地址范围指其可用的网络规模 节点本地(只用于同一计算机通信) 链路本地(只用于同一网络链路或IPv6前缀中的结点) 全球性(Internet范围) IPv6中，大部分节点通常在同一网络接口上使用多个地址 一个IPv6节点需要一组地址，包括组播地址 链路本地IPv6地址使用接口标识符(IID)作为一个单播IPv6地址的分配基础。 IID的长度通常为64位，并直接由一个网络接口相关的链路层MAC地址形成，该地址使用修改的EUI-64格式或由其他进程随机提供的值形成，以提供可防范地址跟踪的某种程度的隐私保护。 EUI表示扩展唯一标识符 EUI-64标识符由一个24位的组织唯一标识符(OUI)+组织分配的40位可扩展标识符组成，并由前24位识别。 OUI由IEEE注册权威机构维护并分配。长度为24位，并占据EUI-48和EUI-64地址的前3个字节。该地址的第一个字节的低两位分别为u位和g位。当u位被设置时，表示该地址是本地管理，当g位被设置时，表示该地址是一组或组播类型的地址。 EUI-64计算方法： 由EUI-48地址形成 将EUI-48地址的24位OUI复制到EUI-64地址 EUI-64地址的4，5字节的16位替换为FFFE 复制由组织分配的剩余位 修改的EUI-64用于形成IPv6地址的IID，但需要对u位取反。 链路本地IPv6地址计算方法： 查看接口MAC地址： 12345678eth0 Link encap:Ethernet HWaddr 00:50:56:9d:a3:b4 inet addr:10.160.14.61 Bcast:10.160.14.255 Mask:255.255.255.0 inet6 addr: fe80::250:56ff:fe9d:a3b4/64 Scope:Link UP BROADCAST RUNNING MULTICAST MTU:1500 Metric:1 RX packets:147710806 errors:2 dropped:3659 overruns:0 frame:0 TX packets:158983119 errors:0 dropped:0 overruns:0 carrier:0 collisions:0 txqueuelen:1000 RX bytes:9252586604 (9.2 GB) TX bytes:35110783086 (35.1 GB) 变换为EUI-64，MAC地址前三节不变，第4，5节插入fffe(固定的)，并复制剩余位 100:50:56:ff:fe:9d:a3:b4 u位取反（第一节内容：0000 0000，后两位分别为0） 1230000 0000:50:56:ff:fe:9d:a3:b4u位取反：0000 0010:50:56:ff:fe:9d:a3:b4 形成的IID为：02:50:56:ff:fe:9d:a3:b4 使用保留的链路本地前缀fe80:/10，形成完整地址，/64为标准长度，用于一个IPv6地址中识别子网/主机部分： 1fe80:250:56ff:fe9d:a3b4 CIDR和聚合前缀无类别域间路由(CIDR) 单播/多播/广播地址单播(Unicast) 通信：一对一，源或目的地址 因特网上的所有系统必须至少有一个唯一的单播地址 可以为A、B或C类 多播(Multicast) 通信：一对多，目的地址 因特网上的系统可以由一个或多个多播地址 只能是D类，本地级(本IP网络内的一组通信节点)或全局级 广播(Broadcast) 通信：一对所有，目的地址 受限广播或直接广播，本地级 类 地址范围 高序位 用途 百分比 网络数 主机数 A 0.0.0.0-127.255.255.255 0 单播/特殊 1/2 128（126） 1677216 B 128.0.0.0-191.255.255.255 10 单播/特殊 1/4 16384 65536 C 192.0.0.0-223.255.255.255 110 单播/特殊 1/8 2097152 256 D 224.0.0.0-239.255.255.255 1110 组播 1/16 N/A N/A E 240.0.0.0-255.255.255.255 1111 保留 1/16 N/A N/A 专用网 不需接入Internet，但需要用TCP/IP通信 编址方案 ​ 申请，并使用A、B、C类地址(全局唯一) ​ 不申请，直接使用A、B、C类地址(本组织唯一，全局不唯一) ​ 不申请，直接使用专用地址(本组织唯一，全局不唯一) 专用地址(私有地址) | 类 | 私有地址 | 总数 || —- | ————————— | —– || A | 10.0.0.0-10.255.255.255 | 1A || B | 172.16.0.0-172.31.255.255 | 16B || C | 192.168.0.0-192.168.255.255 | 256*C | 术语网络号：IP地址的一个组成部分 网络地址：一个IP地址","tags":[]},{"title":"tcpdump基础用法说明","date":"2018-11-19T13:50:55.391Z","path":"2018/11/19/tcpdump基础用法说明/","text":"1. 简介 tcpdump是一个用于截取网络分组，并输出分组内容的工具。根据使用者的定义对网络上的数据包进行截获。 tcpdump针对网络网络层、协议、主机、网络或端口的过滤，并提供and、or、not等逻辑语句辅助去掉无用的信息。 其官网地址为：tcpdump官网，在官网中存在完整的英文说明文档 2. 常用tcpdump语法 抓包选项12345678910-A 以ASCII格式打印出所有分组，并将链路层的头最小化-c 仅抓取指定数量的分组-i 指定监听的网络接口-n 对地址以数字方式显示，否则显示为主机名-nn 除了-n的作用外，还把端口显示为数值，否则显示端口服务器-P 指定要抓取的包是流入还是流出的包。可以给定的值为\"in\"、\"out\"、\"inout\"-XX 输出包的头部数据，会以16进制和ASCII两种方式同时输出，更详细-v 当分析和打印的时候，产生详细的输出-w 将抓包数据输出到文件中-r 从给定的数据包文件中读取数据 2.1 tcpdump表达式表达式用于筛选输出哪些类型的数据包，如果没有给定表达式，所有的数据包都将输出，否则输出表达式为true的包。在表达式中出现的shell元字符建议使用单引号包围。 一个基本的表达式单元格式为：tcpdump [options] [not] proto dir type 1234561. proto:通过给定协议限定匹配的数据包类型 常用的协议有：tcp/udp/arp/ip/ether/icmp等2. dir：指定ID的方向 可以给定的值包括src/dst/src or dst/src and dst3. type：指定ID的类型 可以给定的值有host/net/port/portrange 2.2 tcpdump示例 监视指定网络接口的数据包 1# tcpdump -i eth1 监视指定主机的数据包 123# tcpdump host 1.1.1.1# tcpdump -i eth1 src host 1.1.1.1# tcpdump -i eth1 dst host 1.1.1.1 抓取主机为1.1.1.1的网络数据指定源地址，1.1.1.1指定目的地址，1.1.1.1 监视指定端口 123# tcpdump -i eth1 port 25# tcpdump -i eth1 src port 25# tcpdump -i eth1 dst port 25 网络过滤 123# tcpdump -i eth1 net 1.1# tcpdump -i eth1 src net 1.1# tcpdump -i eth1 dst net 1.1 监视指定协议 12345# tcpdump -i eth1 arp# tcpdump -i eth1 ip# tcpdump -i eth1 tcp# tcpdump -i eth1 udp# tcpdump -i eth1 icmp 示例语句 12抓取经过eth1接口，目的地址为1.1.1.1或1.1.1.2端口是80的tcp数据# tcpdump -i eth1 '((tcp) and (port 80) and ((dst host 1.1.1.1) or (dst host 1.1.1.2)))'","tags":[]},{"title":"Linux下IP及DNS配置","date":"2018-11-18T12:03:51.923Z","path":"2018/11/18/Linux下IP及DNS配置/","text":"linux下配置IP1. 相关文件123456789101112131415161718# cd /etc/network/# vi interfaces(以下为文件内容)# This file describes the network interfaces available on your system# and how to activate them. For more information, see interfaces(5).source /etc/network/interfaces.d/*# The loopback network interfaceauto loiface lo inet loopbackauto eth0iface eth0 inet staticaddress 1.1.15.15netmask 255.255.255.0network 0.0.0.0gateway 1.1.15.1 也可用相关命令：12ifconfig eth0 x.x.x.x netmask x.x.x.x如：ifconfig eth0 1.1.1.1 netmask 255.255.0.0 2. 配置虚拟IP地址相关命令：12ifconfig eth1:0 x.x.x.x netmask 255.255.0.0如：ifconfig eth0:0 2.1.1.1 netmask 255.255.0.0 子网卡并不是实际上的网络接口设备，但可以作为网络接口在设备中出现。其必须依赖于物理网卡 3. 配置DNS相关文件1234567# vi /etc/resolv.conf(以下为文件内容)# Generated by NetworkManager# search localdomain# nameserver 192.168.23.2nameserver 114.114.114.114nameserver 8.8.8.8 修改相应的nameserver内容即可。 若不通，则可继续修改如下文件：1234567891011121314151617181920212223# vi /etc/nsswitch.conf(以下为相关内容)# /etc/nsswitch.conf## Example configuration of GNU Name Service Switch functionality.# If you have the `glibc-doc-reference' and `info' packages installed, try:# `info libc \"Name Service Switch\"' for information about this file.passwd: compatgroup: compatshadow: compatgshadow: files# hosts: files mdns4_minimal [NOTFOUND=return] dns myhostnamehosts: files dns winsnetworks: filesprotocols: db filesservices: db filesethers: db filesrpc: db filesnetgroup: nis 修改相应的hosts部分，添加dns wins即可","tags":[]}]